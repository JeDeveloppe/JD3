{% extends "site/components/_base.html.twig" %}
{% block title %}Mes articles pour ne plus chercher sur Google !{% endblock %}
{% block body %}

    <div class="container my-5">
        <div class="row g-0 justify-content-center">
            <h1 class="col-12 text-center display-4 fw-bold text-primary mb-3">{{ h1 }}</h1>
            <p class="col-12 col-md-10 col-lg-8 text-center text-muted lead mb-5">{{ lead | raw }}</p>
        </div>

        <div class="row g-4 justify-content-center">
            {% for key, category in categories %}
                {# Adjust the columns for better responsiveness #}
                <div class="col-6 col-sm-6 col-md-4 col-lg-3 col-xl-2 d-flex">
                    <article class="card h-100 w-100 shadow-sm border-0 transition-300">
                        <a href="{{ path('mapped_my_articles_from_category', {categorySlug: category.slug }) }}" class="stretched-link"></a>
                        
                        <div class="card-body p-4 text-center">
                            {# Display the icon with a distinct background #}
                            <div class="bg-light p-3 mb-3 d-inline-flex justify-content-center align-items-center rounded-circle">
                                <twig:ux:icon name="{{ category.renderIconStringWithoutParentheses }}" class="technologyIconeSize text-secondary fs-1"/>
                            </div>
                            
                            {# Category title #}
                            <h2 class="h5 fw-bold text-dark mb-2">{{ category.name }}</h2>
                            
                            {# Article count #}
                            {% set articles = (category.articles | length) > 1 ? 'articles' : 'article' %}
                            <p class="text-muted small mb-0">{{ category.articles | length }} {{ articles }}</p>
                        </div>
                        
                        {# Card footer with updated date (with the fix) #}
                        <div class="card-footer bg-light border-0 py-2">
                            <small class="text-muted fst-italic">
                                Mise à jour : 
                                {% if lastArticles[category.name] is defined and lastArticles[category.name] is not null %}
                                    <span class="fw-bold">{{ lastArticles[category.name].updatedAt | date("d/m/Y") }}</span>
                                {% else %}
                                    bientôt...
                                {% endif %}
                            </small>
                        </div>
                    </article>
                </div>
            {% endfor %}
        </div>
    </div>

    {{ knp_pagination_render(categories, 'site/components/_pagination.html.twig') }}

{% endblock %}