{% extends "site/components/_base.html.twig" %}
{% block title %}
    {{ category.name}} - {{ h1 }}
{% endblock %}
{% block body %}

    <div class="container my-5">
        <div class="row g-0 justify-content-center">
            <h1 class="col-12 text-center display-4 fw-bold text-primary mb-3">{{ h1 }}</h1>
            
            {% include "site/components/_breadcrumb.html.twig" with {category: category, article: article} %}
        </div>
        
        <div class="row g-0 justify-content-center mb-5">
            <article class="col-12 col-md-10 col-lg-8">
                <div class="card shadow-lg border-0 rounded-3">
                    <div class="card-body p-4 p-md-5">
                        <div class="article-content">
                            {{ article.description | raw }}
                        </div>
                    </div>
                    <div class="card-footer bg-light d-flex justify-content-end align-items-center py-3">
                        <div class="small text-muted fst-italic">Mise à jour le: <span class="fw-bold">{{ article.updatedAt | date("d/m/Y") }}</span></div>
                    </div>
                </div>
            </article>
        </div>
    </div>
    
    <style>
        .code-container {
            position: relative;
        }

        .copy-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .code-container:hover .copy-button {
            opacity: 1;
        }
    </style>

    <script type="text/javascript">
        // Helper function to show a temporary message
        function showCopySuccess(button) {
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fa-solid fa-check"></i> Copié !';
            button.classList.remove('btn-secondary');
            button.classList.add('btn-success');
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('btn-success');
                button.classList.add('btn-secondary');
            }, 2000);
        }

        document.querySelectorAll('pre').forEach(pre => {
            const button = document.createElement('button');
            button.innerHTML = '<i class="fa-solid fa-clipboard"></i> Copier';
            button.classList.add('btn', 'btn-secondary', 'btn-sm', 'copy-button');

            const container = document.createElement('div');
            container.classList.add('code-container');
            
            pre.parentNode.insertBefore(container, pre);
            container.appendChild(pre);
            container.appendChild(button);

            button.addEventListener('click', () => {
                const textToCopy = pre.textContent;
                navigator.clipboard.writeText(textToCopy).then(() => {
                    showCopySuccess(button);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            });
        });
    </script>
{% endblock %}